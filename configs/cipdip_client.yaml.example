# CIPDIP Client Configuration Example
# Copy this file to cipdip_client.yaml and customize for your target device

adapter:
  name: "CLICK C2-03CPU"   # Human-friendly name (for logs only)
  port: 44818              # EtherNet/IP TCP port (default 44818)

# Protocol behavior (strict ODVA by default)
protocol:
  mode: "strict_odva"        # "strict_odva", "vendor_variant", or "legacy_compat"
  variant: ""                # vendor preset name when mode=vendor_variant
  overrides:
    enip_endianness: "little"        # "little" or "big"
    cip_endianness: "little"         # "little" or "big"
    cip_path_size: true              # include path size byte in CIP requests
    cip_response_reserved: true      # include reserved/status-size fields in CIP responses
    use_cpf: true                    # encode CPF items for SendRRData/SendUnitData
    io_sequence_mode: "increment"    # "increment", "random", or "omit"

# Optional protocol variant list used by the vendor_variants scenario.
protocol_variants:
  - mode: "strict_odva"
  - mode: "vendor_variant"
    variant: "rockwell_v32"
  - mode: "vendor_variant"
    variant: "schneider_m580"
  - mode: "vendor_variant"
    variant: "pcap_capture"
  - mode: "vendor_variant"
    variant: "rockwell_enbt"     # use only when Vendor ID=0x0001 and Product Name=1756-ENBT/A

# CIP targets to read.
# Each entry specifies a CIP path (class/instance/attribute) to read.
read_targets:
  - name: "InputBlock1"
    service: "get_attribute_single"
    class: 0x04
    instance: 0x65
    attribute: 0x03

  - name: "InputBlock2"
    service: "get_attribute_single"
    class: 0x04
    instance: 0x66
    attribute: 0x03

# CIP targets to write.
# Each entry specifies a CIP path and write pattern.
write_targets:
  - name: "OutputBlock1"
    service: "set_attribute_single"
    class: 0x04
    instance: 0x67
    attribute: 0x03
    pattern: "increment"        # "increment", "toggle", or "constant"
    initial_value: 0

# Optional generic/custom services (broader support)
# These entries allow specifying any service code and raw payload template.
custom_targets:
  - name: "CustomServiceExample"
    service: "custom"
    service_code: 0x01          # e.g., Get_Attribute_All, or any CIP service
    class: 0x01                 # example class
    instance: 0x01              # example instance
    attribute: 0x00             # may be unused depending on service
    request_payload_hex: ""      # raw hex string for request body (optional)

# Edge-valid targets for DPI falsification (used by edge_valid scenario)
edge_targets:
  - name: "Class16_Instance8_Attr8"
    service: "get_attribute_single"
    class: 0x0100
    instance: 0x65
    attribute: 0x03
    expected_outcome: "success"
  - name: "Class8_Instance16_Attr16"
    service: "get_attribute_single"
    class: 0x04
    instance: 0x0100
    attribute: 0x0100
    expected_outcome: "success"
  - name: "InvalidClass_Error"
    service: "get_attribute_single"
    class: 0xFFFF
    instance: 0x0001
    attribute: 0x0001
    expected_outcome: "error"
  - name: "PCAP_Class0067_Path"
    service: "get_attribute_single"
    class: 0x0067
    instance: 0x0001
    attribute: 0x0000
    expected_outcome: "any"
  - name: "PCAP_Class00A1_Path"
    service: "get_attribute_single"
    class: 0x00A1
    instance: 0x0001
    attribute: 0x0000
    expected_outcome: "any"
  - name: "PCAP_Unknown_0x4B"
    service: "custom"
    service_code: 0x4B
    class: 0x0067
    instance: 0x0001
    attribute: 0x0000
    expected_outcome: "any"
  - name: "PCAP_Unknown_0x4D"
    service: "custom"
    service_code: 0x4D
    class: 0x00A1
    instance: 0x0001
    attribute: 0x0000
    expected_outcome: "any"
  - name: "PCAP_Unknown_0x52"
    service: "custom"
    service_code: 0x52
    class: 0x0067
    instance: 0x0001
    attribute: 0x0000
    expected_outcome: "any"
  - name: "PCAP_Unknown_0x51"
    service: "custom"
    service_code: 0x51
    class: 0x00A1
    instance: 0x0001
    attribute: 0x0000
    expected_outcome: "any"
  - name: "Rockwell_Read_Tag"
    service: "custom"
    service_code: 0x4C
    class: 0x0067
    instance: 0x0001
    attribute: 0x0000
    expected_outcome: "any"
  - name: "Rockwell_Write_Tag"
    service: "custom"
    service_code: 0x4D
    class: 0x0067
    instance: 0x0001
    attribute: 0x0000
    expected_outcome: "any"
  - name: "Rockwell_Read_Tag_Fragmented"
    service: "custom"
    service_code: 0x52
    class: 0x0067
    instance: 0x0001
    attribute: 0x0000
    expected_outcome: "any"
  - name: "Rockwell_Write_Tag_Fragmented"
    service: "custom"
    service_code: 0x53
    class: 0x0067
    instance: 0x0001
    attribute: 0x0000
    expected_outcome: "any"
  - name: "ConnMgr_Get_Connection_Data"
    service: "custom"
    service_code: 0x56
    class: 0x0006
    instance: 0x0001
    attribute: 0x0000
    expected_outcome: "any"
  - name: "ConnMgr_Search_Connection_Data"
    service: "custom"
    service_code: 0x57
    class: 0x0006
    instance: 0x0001
    attribute: 0x0000
    expected_outcome: "any"
  - name: "ConnMgr_Get_Connection_Owner"
    service: "custom"
    service_code: 0x5A
    class: 0x0006
    instance: 0x0001
    attribute: 0x0000
    expected_outcome: "any"
  - name: "ConnMgr_Large_Forward_Open"
    service: "custom"
    service_code: 0x5B
    class: 0x0006
    instance: 0x0001
    attribute: 0x0000
    expected_outcome: "any"

# Optional per-scenario jitter in milliseconds (0 disables).
scenario_jitter_ms: 0
# Optional I/O connections for connected Class 1 I/O-style behavior
# Used by the 'io' scenario
io_connections:
  - name: "IOConn1"
    transport: "udp"             # "udp" (default) or "tcp"
    o_to_t_rpi_ms: 20           # Requested Packet Interval (originator to target)
    t_to_o_rpi_ms: 20           # Requested Packet Interval (target to originator)
    o_to_t_size_bytes: 8         # Size of O->T connection data (bytes)
    t_to_o_size_bytes: 8        # Size of T->O connection data (bytes)
    priority: "scheduled"        # or "low", "high", "urgent"
    transport_class_trigger: 3   # CIP transport class; 1, 2, or 3 (typically 1 or 3 for cyclic)
    class: 0x04                 # Logical CIP path to the target object or assembly
    instance: 0x65
    connection_path_hex: ""     # Optional raw hex path if needed for complex routing

